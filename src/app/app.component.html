<main class="app-main" [@routeAnimations]="prepareRoute()">
  <nav class="navbar navbar-expand-lg bg-body-tertiary px-3">
    <a class="navbar-brand" routerLink="/">Clínica Online</a>

    <div class="ms-auto d-flex align-items-center gap-2">
      <ng-container
        *ngIf="
          ready() &&
            isLogged() &&
            !(
              profile()?.role === 'especialista' &&
              profile()?.is_approved === false
            );
          else loggedOut
        "
      >
        <span class="text-muted">
          Hola, {{ profile()?.nombre || "Usuario" }}
        </span>

        <a
          class="btn btn-outline-primary btn-sm"
          *ngIf="profile()?.role === 'admin'"
          routerLink="/admin/usuarios"
        >
          Usuarios
        </a>

        <a class="btn btn-outline-secondary btn-sm" routerLink="/perfil">
          <i class="bi bi-person-circle me-1"></i> Mi perfil
        </a>

        <button class="btn btn-warning btn-sm" (click)="logout()">Salir</button>
      </ng-container>

      <ng-template #loggedOut>
        <a class="btn btn-outline-secondary btn-sm" routerLink="/login">
          Login
        </a>
        <a class="btn btn-primary btn-sm" routerLink="/registro"> Registro </a>
      </ng-template>
    </div>
  </nav>

  <!-- router-outlet normal, SIN #outlet y SIN animación acá -->
  <ng-container *ngIf="ready(); else booting">
    <router-outlet></router-outlet>
  </ng-container>

  <ng-template #booting>
    <div class="text-center mt-5">Cargando...</div>
  </ng-template>

  <app-loader [active]="loader.active()"></app-loader>
  <app-toasts></app-toasts>
</main>
