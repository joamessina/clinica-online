<!-- Encabezado -->
<div class="d-flex align-items-center justify-content-between mb-3">
  <h3 class="mb-0">Mis turnos</h3>

  <!-- botón volver a la derecha -->
  <app-back-button variant="outline-secondary" size="sm" label="Volver">
  </app-back-button>
</div>

<input
  class="form-control mb-3"
  [ngModel]="q()"
  (ngModelChange)="q.set($event)"
  placeholder="Filtrar por especialidad o especialista..."
/>

<div class="table-responsive">
  <table class="table align-middle">
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Hora</th>
        <th>Especialidad</th>
        <th>Especialista</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let t of filtered()">
        <td>{{ t.fecha | date : "d/MM" }}</td>
        <td>{{ t.hora?.slice(0, 5) }}</td>
        <td>{{ t.especialidad_nombre }}</td>
        <td>{{ t.especialista_nombre }}</td>
        <td>
          <span class="badge" [attr.data-status]="t.estado">{{
            t.estado
          }}</span>
        </td>

        <td class="actions">
          <div class="btn-group btn-group-sm flex-wrap">
            <button
              class="btn btn-outline-danger"
              *ngIf="canCancel(t)"
              (click)="cancelar(t)"
            >
              Cancelar
            </button>

            <button
              class="btn btn-outline-secondary"
              *ngIf="hasResena(t)"
              (click)="verResena(t)"
            >
              Ver reseña
            </button>

            <button
              class="btn btn-outline-primary"
              *ngIf="canSurvey(t)"
              (click)="abrirEncuesta(t)"
            >
              Completar encuesta
            </button>

            <button
              class="btn btn-success"
              *ngIf="canFeedback(t)"
              (click)="feedback(t)"
            >
              Calificar atención
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
