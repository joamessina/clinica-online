<!-- mis-horarios.component.html -->

<!-- HEADER EN FORMA DE PASTILLA -->
<div class="horarios-header mb-3">
  <div class="d-flex align-items-center gap-2">
    <app-back-button
      variant="secondary"
      size="sm"
      label="Volver"
    ></app-back-button>

    <div class="header-text">
      <h2 class="mb-0">Mis horarios</h2>
      <p class="mb-0">
        Definí en qué días y horarios atendés, y cuánto duran tus turnos.
      </p>
    </div>
  </div>
</div>

<!-- CARD DE CONFIGURACIÓN -->
<div class="card config-card mb-3">
  <div class="card-body">
    <div class="row g-3 align-items-start">
      <!-- ESPECIALIDADES -->
      <div class="col-md-4">
        <label class="form-label fw-semibold">Especialidad</label>
        <div class="d-flex flex-wrap gap-2 specialty-chips">
          <button
            class="btn btn-outline-primary"
            *ngFor="let s of specialties"
            [class.active]="form.specialty === s.id"
            (click)="form.specialty = s.id"
          >
            {{ s.nombre }}
          </button>
        </div>
      </div>

      <!-- DÍA / HORARIO / SLOT -->
      <div class="col-md-8">
        <label class="form-label fw-semibold d-block mb-1">
          Nuevo tramo de atención
        </label>
        <div class="row g-2 align-items-end horarios-row">
          <div class="col-6 col-md-3">
            <label class="form-label">Día</label>
            <select class="form-select" [(ngModel)]="form.weekday" name="wd">
              <option [ngValue]="0">Dom</option>
              <option [ngValue]="1">Lun</option>
              <option [ngValue]="2">Mar</option>
              <option [ngValue]="3">Mié</option>
              <option [ngValue]="4">Jue</option>
              <option [ngValue]="5">Vie</option>
              <option [ngValue]="6">Sáb</option>
            </select>
          </div>

          <div class="col-6 col-md-3">
            <label class="form-label">Desde</label>
            <input
              class="form-control"
              [(ngModel)]="form.desde"
              name="desde"
              placeholder="HH:mm"
            />
          </div>

          <div class="col-6 col-md-3">
            <label class="form-label">Hasta</label>
            <input
              class="form-control"
              [(ngModel)]="form.hasta"
              name="hasta"
              placeholder="HH:mm"
            />
          </div>

          <div class="col-2">
            <label class="form-label">Slot (min)</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="form.slot"
              name="slot"
              min="30"
              step="5"
            />
          </div>

          <div class="col-12 col-md-1">
            <button class="btn btn-primary w-100 add-slot-btn" (click)="add()">
              Agregar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- TABLA DE TRAMOS -->
<h5 class="section-title">Tramos cargados</h5>
<div class="table-responsive schedule-table">
  <table class="table table-hover align-middle mb-0">
    <thead>
      <tr>
        <th>Día</th>
        <th>Especialidad</th>
        <th>Desde</th>
        <th>Hasta</th>
        <th>Slot</th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="let a of avail; let i = index"
        [class.conflict]="i === conflictIndex"
      >
        <!-- nombre de día en vez de número -->
        <td>{{ weekdayLabel(a.weekday) }}</td>
        <td>{{ a.specialty_name }}</td>
        <td>{{ a.hora_desde }}</td>
        <td>{{ a.hora_hasta }}</td>
        <td>{{ a.slot_minutes }}m</td>
      </tr>
    </tbody>
  </table>
</div>
