<!-- Encabezado -->
<div class="d-flex align-items-center justify-content-between mb-3">
  <!-- botón volver a la derecha -->
  <app-back-button variant="outline-secondary" size="sm" label="Volver">
  </app-back-button>
</div>
<div class="container py-4" *ngIf="!loading(); else cargando">
  <h2 class="mb-3">Mi perfil</h2>

  <div class="card shadow-sm">
    <div class="card-body d-flex gap-3 align-items-center">
      <img
        [src]="perfil()?.avatar_url"
        class="rounded-circle"
        width="96"
        height="96"
        alt="Avatar"
      />
      <div>
        <div class="h5 mb-1">
          {{ perfil()?.nombre }} {{ perfil()?.apellido }}
        </div>
        <div class="text-muted">
          <span class="badge bg-secondary me-2 text-uppercase">{{
            perfil()?.role
          }}</span>
          {{ perfil()?.email }}
        </div>
      </div>
    </div>

    <div class="card-body border-top">
      <div class="row g-3">
        <div class="col-md-4">
          <strong>DNI:</strong> {{ perfil()?.dni || "—" }}
        </div>
        <div class="col-md-4">
          <strong>Edad:</strong> {{ perfil()?.edad || "—" }}
        </div>
        <div class="col-md-4" *ngIf="perfil()?.role === 'paciente'">
          <strong>Obra social:</strong> {{ perfil()?.obra_social || "—" }}
        </div>

        <div class="col-12" *ngIf="perfil()?.role === 'especialista'">
          <strong>Especialidades:</strong>
          <ng-container
            *ngIf="(perfil()?.specialties?.length || 0) > 0; else noSpec"
          >
            <span
              class="badge bg-outline border me-2"
              *ngFor="let s of perfil()?.specialties"
            >
              {{ s.nombre }}
            </span>
          </ng-container>
          <ng-template #noSpec>—</ng-template>
        </div>
      </div>

      <!-- Solo especialistas: acceso directo a mis horarios -->
      <div class="mt-3" *ngIf="perfil()?.role === 'especialista'">
        <a
          class="btn btn-outline-primary"
          routerLink="/especialista/mis-horarios"
        >
          <i class="bi bi-clock me-1"></i> Mis horarios
        </a>
      </div>
    </div>
  </div>
</div>

<ng-template #cargando>
  <div class="container py-5 text-center text-muted">Cargando perfil…</div>
</ng-template>
